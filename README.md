# DockRefine
This is the implementation of DockRefine: a post-docking rescoring method based on ligand similarity comparison and Drug-Target interaction
## About DockRefine
The DockRefine rescoring workflow is based on the ligand similarity comparison method and uses LS-align to search the similarity of compound libraries and give a similarity score. GAT was also used to learn the DTI patterns of target proteins and their corresponding active compounds, and DTI classification predictions were given for the compound library. By lowering the ranking of compounds with the incorrect DTI and increasing the ranking of compounds with the correct DTI to modify the ligand similarity score, the problem of poor specificity of the ligand similarity search method and more false positive results of the head compound can be solved.
## Installation
DockRefine is built on Python3, we recommend using Anaconda environment as enviroment management for the installation of DockRefine and its dependencies. The virtual environment can be created as follows:
```
conda create -n your_environment python==3.7
conda activate your_environment
```
Install DockRefine dependencies as following:
```
conda install rdkit rdkit
conda install openbabel -c conda-forge
conda install -c conda-forge smina
conda install pytorch==1.9.0 torchvision==0.10.0 torchaudio==0.9.0 cuda-toolkit=10.2 â€“c pytorch
```
## Executing workflow
DockRefine needs three steps:
1. prepare the screening compounds (MOL2 format and SDF format) and pocket ('.POC' format) into the input folder.
put all compounds into (DockRefine/input_ligand_mol2/ and DockRefine/input_ligand_sdf/) subfolder.
put the pocket file (named as 7MFC.poc") into the (DockRefine/input_pocket/) subfolder.The pocket is like as:
```
POC     7MFC
ATOM    253  N   VAL A  49       6.937   3.497 -28.457  1.00 34.68           N
ATOM    254  CA  VAL A  49       6.465   2.179 -28.887  1.00 34.68           C
ATOM    255  C   VAL A  49       5.665   2.297 -30.179  1.00 34.68           C
ATOM    256  O   VAL A  49       5.965   1.651 -31.192  1.00 34.68           O
...
TRE
```
2.Prepare the 7A binding pocket corresponding to the ligand in the training set and test set of the DTI module(DockRefine/data_for_classification/total),it can be generated by pymol.Put all pocket('.pdb'format) into (DockRefine/data_for_classification/template_pocket_7A/)

3.run main_script.py
```
python main_script.py
```
## Examples of results
```
Ranking	Compound ID	Rescore
1	active_CHEMBL4100838	1.8648
2	active_CHEMBL4068526	1.8633
3	active_CHEMBL2023494	1.854
4	active_CHEMBL4074076	1.85
5	active_CHEMBL1171837	1.8492
6	active_CHEMBL4059858	1.8461
7	active_CHEMBL4847875	1.844
8	active_CHEMBL4063659	1.8425
9	active_CHEMBL5197530	1.842
10	active_CHEMBL3646210	1.8396
11	active_CHEMBL4085366	1.8396
12	active_CHEMBL5186979	1.8373
13	active_CHEMBL3646211	1.8342
14	active_CHEMBL4466555	1.8326
15	active_CHEMBL4583679	1.8322
16	active_CHEMBL4851635	1.8318
17	active_CHEMBL4471379	1.8313
18	active_CHEMBL4081527	1.8303
19	active_CHEMBL4436123	1.8299
20	active_CHEMBL475817	1.8297
```
